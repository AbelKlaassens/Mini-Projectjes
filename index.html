<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>De Slimste Emil</title>

<!-- mobiel + niet zoomen -->
<meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<style>
    * { box-sizing: border-box; }

    html, body {
        margin: 0;
        padding: 0;
        background: #b62318;
        font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
        color: white;
    }

    /* STARTSCHERM */
    #start-screen {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 20px;
    }

    #start-inner {
        max-width: 400px;
    }

    #start-inner p {
        font-size: 20px;
        margin-bottom: 16px;
    }

    #start-inner button {
        padding: 10px 16px;
        border-radius: 8px;
        border: none;
        background: #ffffff;
        color: #b62318;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
    }

    /* SPEL */
    #game {
        display: none;
    }

    #top {
        max-width: 650px;
        margin: 0 auto;
        padding: 12px 10px 80px;
    }

    h1 {
        margin: 0 0 4px;
        font-size: 22px;
        text-align: center;
    }

    #round-label {
        font-size: 16px;
        text-align: center;
        margin-bottom: 2px;
    }

    #round-question {
        font-size: 15px;
        text-align: center;
        margin-bottom: 6px;
    }

    #timer {
        font-size: 26px;
        margin-bottom: 4px;
        font-weight: bold;
        text-align: center;
    }

    #bottles {
        font-size: 18px;
        margin-bottom: 10px;
        text-align: center;
    }

    .puzzel-container {
        width: 100%;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
        margin-top: 10px;
    }

    .tile {
        background: rgba(255,255,255,0.15);
        padding: 12px 4px;
        border-radius: 10px;
        font-size: 16px;
        text-align: center;
        transition: 0.3s;
        min-height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .tile.correct {
        background: #63c76a;
        color: #000;
        font-weight: 600;
    }

    /* Speciaal voor ronde 4 (open deur) */
    .tile.open-door {
        text-decoration: line-through;
        text-decoration-thickness: 2px;
        text-decoration-color: #ffffff;
        color: transparent;              /* tekst zelf onzichtbaar */
    }

    .tile.open-door.correct {
        text-decoration: none;
        color: #000;                      /* tekst zichtbaar */
        background: #63c76a;
        opacity: 1;
        font-weight: 600;
    }

    #result {
        margin-top: 8px;
        font-size: 18px;
        text-align: center;
    }

    #answers {
        margin-top: 10px;
        text-align: center;
    }

    .answer {
        display: inline-block;
        margin: 3px 6px;
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 15px;
    }

    .answer.solved {
        background: #63c76a;
        color: #000;
        font-weight: 600;
    }

    .answer.missed {
        background: rgba(0,0,0,0.35);
        color: #fff;
    }

    #input-wrapper {
        background: #b62318;
        border-top: 1px solid rgba(255,255,255,0.25);
    }

    #input-area {
        max-width: 650px;
        margin: 0 auto;
        padding: 8px 10px 14px;
        display: flex;
        gap: 8px;
    }

    #guess {
        flex: 1;
        padding: 10px 12px;
        border-radius: 8px;
        border: none;
        font-size: 16px;
        outline: none;
    }

    button {
        padding: 10px 14px;
        border-radius: 8px;
        border: none;
        background: #ffffff;
        color: #b62318;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
    }

    #next-round-btn {
        margin-top: 10px;
    }

    @media (max-width: 480px) {
        h1 { font-size: 20px; }
        .tile {
            font-size: 14px;
            padding: 10px 2px;
            min-height: 36px;
        }
    }
</style>
</head>
<body>

<!-- STARTSCHERM -->
<div id="start-screen">
  <div id="start-inner">
    <p>Succes Emil! Ik hoop dat je veel moet drinken.</p>
    <button id="start-btn">Start spel</button>
  </div>
</div>

<!-- SPEL -->
<div id="game">
  <div id="top">
      <h1>De Slimste Emil – Puzzel</h1>
      <div id="round-label"></div>
      <div id="round-question"></div>
      <div id="timer"></div>
      <div id="bottles"></div>
      <div class="puzzel-container" id="tiles"></div>
      <div id="result"></div>
      <div id="answers"></div>
  </div>

  <div id="input-wrapper">
      <div id="input-area">
          <input id="guess" placeholder="Typ jouw antwoord..." autocomplete="off">
          <button onclick="checkGuess()">Gok!</button>
      </div>
  </div>
</div>

<script>
// -----------------------------
// RONDES
// -----------------------------
const rounds = [
    {
        name: "Ronde 1",
        question: "",
        type: "words",
        words: [
            { key: "ELLA", label: "Ella", aliases: [], hints: ["Mascotte","Roel","Yves","dizkartes"] },
            { key: "BILAL", label: "Bilal", aliases: [], hints: ["Marrakech","geit","Fully Gucci","Moslim"] },
            { key: "ALFAVILLA", label: "Alfa villa", aliases: [], hints: ["Albanie","Wit","bad","buren"] }
        ]
    },
    {
        name: "Ronde 2",
        question: "",
        type: "words",
        words: [
            { key: "HBOERS", label: "HBO’ers", aliases: ["HBO"], hints: ["Ties","Tim","Derek","Joost"] },
            { key: "VO", label: "Vo", aliases: [], hints: ["1815","27","Proost","olifant"] },
            { key: "NOORDERPLANTSOEN", label: "Noorderplantsoen", aliases: [], hints: ["Gras","Park","Melkinrichting","Zondag"] }
        ]
    },
    {
        name: "Ronde 3 – Meerkeuze",
        question: "Hoeveel heeft Loesoe uitgegeven op WBW in totaal?",
        type: "multiplechoice",
        answers: [
            { key: "A", label: "A. €59.935", correct: true },
            { key: "B", label: "B. €62.858", correct: false },
            { key: "C", label: "C. €72.012", correct: false },
            { key: "D", label: "D. €49.873", correct: false }
        ]
    },
    {
        name: "Ronde 4 – Open deur",
        question: "Wat weet je over Loesoe? (4 antwoorden)",
        type: "words",
        time: 20,
        words: [
            { key: "ZEVEN",     label: "Zeven",     aliases: ["7","SEVEN"],  hints: [] },
            { key: "ALBERTUS",  label: "Albertus",  aliases: ["MAGNUS"],     hints: [] },
            { key: "MOOI",      label: "Mooi",      aliases: [],             hints: [] },
            { key: "CLUB",      label: "Club",      aliases: [],             hints: [] }
        ]
    }
];

// -----------------------------
// GLOBALS
// -----------------------------
let solved = new Set();
let bottles = 11; // START MET 11 FLESSEN
let timer, time;

function normalize(str) {
    return str.toUpperCase().replace(/\s+/g,"").replace(/['’]/g,"");
}

const tiles       = document.getElementById("tiles");
const roundLabel  = document.getElementById("round-label");
const questionLbl = document.getElementById("round-question");
const timerEl     = document.getElementById("timer");
const bottlesEl   = document.getElementById("bottles");
const resultEl    = document.getElementById("result");
const answersEl   = document.getElementById("answers");
const input       = document.getElementById("guess");

let currentIndex = 0;
let currentRound = null;
let solutionMap  = {};

function updateBottles() {
    bottlesEl.textContent = "Flessen: " + bottles;
}

function startTimer() {
    clearInterval(timer);
    time = currentRound.time || 40;
    timerEl.textContent = time;

    timer = setInterval(() => {
        time--;
        timerEl.textContent = time;
        if (time <= 0) {
            clearInterval(timer);
            endRound();
        }
    }, 1000);
}

function buildTiles() {
    tiles.innerHTML = "";
    solutionMap = {};

    if (currentRound.type === "multiplechoice") {
        currentRound.answers.forEach(a => {
            const t = document.createElement("div");
            t.className = "tile";
            t.dataset.choice = a.key;
            t.textContent = a.label;
            tiles.appendChild(t);
        });
        return;
    }

    currentRound.words.forEach(w => {
        solutionMap[w.key] = w;

        if (w.hints && w.hints.length > 0) {
            // normale puzzelrondes met hints
            w.hints.forEach(h => {
                const t = document.createElement("div");
                t.className = "tile";
                t.dataset.solution = w.key;
                t.textContent = h;
                tiles.appendChild(t);
            });
        } else {
            // OPEN DEUR: toon woord zelf, doorgestreept & onleesbaar
            const t = document.createElement("div");
            t.className = "tile open-door";
            t.dataset.solution = w.key;
            t.textContent = w.label;
            tiles.appendChild(t);
        }
    });
}

function startRound(i) {
    currentIndex = i;
    currentRound = rounds[i];
    roundLabel.textContent = `${currentRound.name} van ${rounds.length}`;
    questionLbl.textContent = currentRound.question || "";
    resultEl.innerHTML = "";
    answersEl.innerHTML = "";
    input.disabled = false;
    input.value = "";
    input.focus();
    buildTiles();
    startTimer();
    window.scrollTo({ top: 0, left: 0, behavior: "instant" });
}

function endRound() {
    input.disabled = true;
    answersEl.innerHTML = "";

    if (currentRound.type === "multiplechoice") {
        const correct = currentRound.answers.find(a => a.correct);
        const head = document.createElement("div");
        head.id = "answers-title";
        head.textContent = "Juiste antwoord:";
        answersEl.appendChild(head);

        const span = document.createElement("span");
        span.className = "answer " + (solved.has("MCQ_"+currentIndex) ? "solved" : "missed");
        span.textContent = correct.label;
        answersEl.appendChild(span);

        resultEl.innerHTML =
            `Ronde afgelopen!<br>Overgebleven flessen: <strong>${bottles}</strong>.<br><br>`;
    } else {
        const head = document.createElement("div");
        head.id = "answers-title";
        head.textContent = "Oplossingen:";
        answersEl.appendChild(head);

        currentRound.words.forEach(w => {
            const span = document.createElement("span");
            span.className = "answer " + (solved.has(w.key) ? "solved" : "missed");
            span.textContent = w.label;
            answersEl.appendChild(span);
        });

        const missed = currentRound.words.filter(w => !solved.has(w.key)).length;
        resultEl.innerHTML =
            `Ronde afgelopen!<br>Niet geraden: <strong>${missed}</strong>.<br>` +
            `Overgebleven flessen: <strong>${bottles}</strong><br><br>`;
    }

    if (currentIndex < rounds.length - 1) {
        const btn = document.createElement("button");
        btn.id = "next-round-btn";
        btn.textContent = "Volgende ronde";
        btn.onclick = () => startRound(currentIndex + 1);
        resultEl.appendChild(btn);
    } else {
        // laatste ronde: eindtekst + opnieuw-knop
        resultEl.innerHTML +=
            `<span style="display:block;margin-top:10px;font-size:26px;font-weight:bold;">
               Succes met het drinken van de ${bottles} bier!
             </span><br><br>`;
        const restart = document.createElement("button");
        restart.textContent = "Opnieuw spelen";
        restart.onclick = () => window.location.reload();
        resultEl.appendChild(restart);
    }
}

// -----------------------------
// INPUT EVENTS
// -----------------------------
input.addEventListener("keyup", e => {
    if (e.key === "Enter") checkGuess();
});

// scroll hack voor mobiel
input.addEventListener("focus", () => {
    setTimeout(() => {
        input.scrollIntoView({ block: "center", behavior: "smooth" });
    }, 300);
});

// -----------------------------
// CHECK GUESS
// -----------------------------
function checkGuess() {
    if (input.disabled) return;
    const raw  = input.value.trim();
    const norm = normalize(raw);
    input.value = "";

    // --- RONDE 3: MEERKEUZE (1 KANS) ---
    if (currentRound.type === "multiplechoice") {
        let choice = null;

        if (norm === "A" || norm === "A.") choice = "A";
        else if (norm === "B" || norm === "B.") choice = "B";
        else if (norm === "C" || norm === "C.") choice = "C";
        else if (norm === "D" || norm === "D.") choice = "D";
        else if (norm === "59935" || norm === "59.935") choice = "A";

        clearInterval(timer); // altijd direct stoppen

        if (choice === "A") {
            solved.add("MCQ_"+currentIndex);
            if (bottles > 0) bottles--;
            updateBottles();

            document.querySelectorAll("[data-choice]").forEach(el => {
                if (el.dataset.choice === "A") el.classList.add("correct");
            });
        }

        endRound();
        return;
    }

    // --- NORMALE / OPEN-DEUR RONDES ---
    let found = null;

    if (solutionMap[norm]) found = solutionMap[norm];

    if (!found) {
        for (const w of currentRound.words) {
            for (const a of (w.aliases || [])) {
                if (normalize(a) === norm) {
                    found = w;
                    break;
                }
            }
            if (found) break;
        }
    }

    if (found && !solved.has(found.key)) {
        solved.add(found.key);

        document
            .querySelectorAll(`[data-solution="${found.key}"]`)
            .forEach(t => t.classList.add("correct"));

        if (bottles > 0) {
            bottles--;
            updateBottles();
        }

        if (currentRound.words.every(w => solved.has(w.key))) {
            clearInterval(timer);
            endRound();
            return;
        }
    }
}

// -----------------------------
// STARTSCHERM LOGICA
// -----------------------------
document.getElementById("start-btn").addEventListener("click", () => {
    document.getElementById("start-screen").style.display = "none";
    document.getElementById("game").style.display = "block";
    updateBottles();
    startRound(0);
});
</script>

</body>
</html>




