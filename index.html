<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>De Slimste Emil</title>

<!-- mobiel + niet zoomen -->
<meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<style>
    * { box-sizing: border-box; }

    html, body {
        margin: 0;
        padding: 0;
        background: #b62318;
        font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
        color: white;
    }

    #top {
        max-width: 650px;
        margin: 0 auto;
        padding: 12px 10px 80px;
    }

    h1 {
        margin: 0 0 4px;
        font-size: 22px;
        text-align: center;
    }

    #round-label {
        font-size: 16px;
        text-align: center;
        margin-bottom: 4px;
    }

    #timer {
        font-size: 26px;
        margin-bottom: 4px;
        font-weight: bold;
        text-align: center;
    }

    #bottles {
        font-size: 18px;
        margin-bottom: 10px;
        text-align: center;
    }

    .puzzel-container {
        width: 100%;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
        margin-top: 10px;
    }

    .tile {
        background: rgba(255,255,255,0.15);
        padding: 12px 4px;
        border-radius: 10px;
        font-size: 16px;
        text-align: center;
        transition: 0.3s;
        min-height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .tile.correct {
        background: #63c76a;
        color: #000;
        font-weight: 600;
    }

    #result {
        margin-top: 8px;
        font-size: 18px;
        text-align: center;
    }

    #answers {
        margin-top: 10px;
        text-align: center;
    }

    #answers-title {
        font-size: 16px;
        margin-bottom: 4px;
    }

    .answer {
        display: inline-block;
        margin: 3px 6px;
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 15px;
    }

    .answer.solved {
        background: #63c76a;
        color: #000;
        font-weight: 600;
    }

    .answer.missed {
        background: rgba(0,0,0,0.35);
        color: #fff;
    }

    /* Onderste deel: input + knop */
    #input-wrapper {
        background: #b62318;
        border-top: 1px solid rgba(255,255,255,0.25);
    }

    #input-area {
        max-width: 650px;
        margin: 0 auto;
        padding: 8px 10px 14px;
        display: flex;
        gap: 8px;
    }

    #guess {
        flex: 1;
        padding: 10px 12px;
        border-radius: 8px;
        border: none;
        font-size: 16px;   /* voorkomt auto-zoom op iOS */
        outline: none;
    }

    button {
        padding: 10px 14px;
        border-radius: 8px;
        border: none;
        background: #ffffff;
        color: #b62318;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
    }

    button:active { transform: scale(0.98); }

    #next-round-btn {
        margin-top: 10px;
    }

    @media (max-width: 480px) {
        h1 { font-size: 20px; }
        .tile {
            font-size: 14px;
            padding: 10px 2px;
            min-height: 36px;
        }
    }
</style>
</head>
<body>

<div id="top">
    <h1>De Slimste Emil – Puzzel</h1>
    <div id="round-label">Ronde 1 van 2</div>
    <div id="timer">40</div>
    <div id="bottles">Flessen: 10</div>
    <div class="puzzel-container" id="tiles"></div>
    <div id="result"></div>
    <div id="answers"></div>
</div>

<div id="input-wrapper">
    <div id="input-area">
        <input id="guess" placeholder="Typ jouw antwoord..." autocomplete="off">
        <button onclick="checkGuess()">Gok!</button>
    </div>
</div>

<script>
// -----------------------------
// DATA: 2 rondes, 3 woorden elk
// -----------------------------
const rounds = [
    {
        name: "Ronde 1",
        words: [
            {
                key: "ELLA",
                label: "Ella",
                hints: ["Mascotte", "Roel", "Yves", "dizkartes"]
            },
            {
                key: "BILAL",
                label: "Bilal",
                hints: ["Marrakech", "geit", "Fully Gucci", "Moslim"]
            },
            {
                key: "ALFAVILLA",
                label: "Alfa villa",
                hints: ["Albanie", "Wit", "bad", "buren"]
            }
        ]
    },
    {
        name: "Ronde 2",
        words: [
            {
                key: "HBOERS",
                label: "HBO\u2019ers",
                hints: ["Ties", "Tim", "Derek", "Joost"]
            },
            {
                key: "VO",
                label: "Vo",
                hints: ["1815", "27", "Proost", "olifant"]
            },
            {
                key: "NOORDERPLANTSOEN",
                label: "Noorderplantsoen",
                hints: ["Gras", "Park", "Melkinrichting", "Zondag"]
            }
        ]
    }
];

// normaliseer input: hoofdletters, spaties weg, apostrof-varianten weg
function normalize(str) {
    return str
        .toUpperCase()
        .replace(/\s+/g, "")
        .replace(/['’]/g, "");
}

const tilesContainer = document.getElementById("tiles");
const timerElement = document.getElementById("timer");
const bottlesElement = document.getElementById("bottles");
const resultElement = document.getElementById("result");
const answersElement = document.getElementById("answers");
const roundLabelElement = document.getElementById("round-label");
const input = document.getElementById("guess");

let currentRoundIndex = 0;
let currentRound = null;
let currentSolutionMap = {};   // key -> word object (label, hints)
let solvedGlobal = new Set();  // alle goed geraden woorden over beide rondes
let bottles = 10;
let time = 40;
let timer = null;

// -----------------------------
// UI helpers
// -----------------------------
function updateBottles() {
    bottlesElement.textContent = `Flessen: ${bottles}`;
}

function updateRoundLabel() {
    roundLabelElement.textContent = `${currentRound.name} van ${rounds.length}`;
}

function buildTiles() {
    tilesContainer.innerHTML = "";
    currentSolutionMap = {};

    currentRound.words.forEach(word => {
        currentSolutionMap[word.key] = word;
        word.hints.forEach(h => {
            const tile = document.createElement("div");
            tile.className = "tile";
            tile.dataset.solution = word.key;
            tile.innerText = h;
            tilesContainer.appendChild(tile);
        });
    });
}

function markTilesForKey(key) {
    document
        .querySelectorAll(`[data-solution='${key}']`)
        .forEach(el => el.classList.add("correct"));
}

function showAnswersForCurrentRound() {
    answersElement.innerHTML = "";
    const title = document.createElement("div");
    title.id = "answers-title";
    title.textContent = "Oplossingen:";
    answersElement.appendChild(title);

    currentRound.words.forEach(word => {
        const span = document.createElement("span");
        span.className = "answer " + (solvedGlobal.has(word.key) ? "solved" : "missed");
        span.textContent = word.label;
        answersElement.appendChild(span);
    });
}

// -----------------------------
// Ronde & timer
// -----------------------------
function startTimer() {
    if (timer) clearInterval(timer);
    time = 40;
    timerElement.textContent = time;

    timer = setInterval(() => {
        time--;
        timerElement.textContent = time;
        if (time <= 0) {
            clearInterval(timer);
            endRound();
        }
    }, 1000);
}

function startRound(index) {
    currentRoundIndex = index;
    currentRound = rounds[currentRoundIndex];

    updateRoundLabel();
    buildTiles();
    resultElement.innerHTML = "";
    answersElement.innerHTML = "";
    input.disabled = false;
    input.value = "";
    input.focus();
    startTimer();
    window.scrollTo({ top: 0, left: 0, behavior: "instant" });
}

function endRound() {
    input.disabled = true;

    const notSolved = currentRound.words.filter(w => !solvedGlobal.has(w.key));
    const missedCount = notSolved.length;

    showAnswersForCurrentRound();

    // tekst + eventueel knop voor volgende ronde
    let html =
        `Tijd is op voor ${currentRound.name}!<br>` +
        `Niet geraden woorden: <strong>${missedCount}</strong>.<br>` +
        `Overgebleven flessen: <strong>${bottles}</strong>.`;

    if (currentRoundIndex < rounds.length - 1) {
        html += `<br><br>`;
        resultElement.innerHTML = html;

        const btn = document.createElement("button");
        btn.id = "next-round-btn";
        btn.textContent = "Volgende ronde";
        btn.onclick = () => startRound(currentRoundIndex + 1);
        resultElement.appendChild(btn);
    } else {
        html += `<br><br>Spel afgelopen!`;
        resultElement.innerHTML = html;
    }
}

// -----------------------------
// Raden
// -----------------------------
input.addEventListener("keyup", (e) => {
    if (e.key === "Enter") {
        checkGuess();
    }
});

// laten we je scrollen naar midden bij focus (zoals je eerdere versie)
input.addEventListener("focus", () => {
    setTimeout(() => {
        input.scrollIntoView({ block: "center", behavior: "smooth" });
    }, 300);
});

function checkGuess() {
    if (input.disabled) return;

    const rawGuess = input.value.trim();
    const guessKey = normalize(rawGuess);

    const wordObj = currentSolutionMap[guessKey];
    if (wordObj && !solvedGlobal.has(wordObj.key)) {
        solvedGlobal.add(wordObj.key);
        markTilesForKey(wordObj.key);

        if (bottles > 0) {
            bottles--;
            updateBottles();
        }
    }

    input.value = "";
    input.focus();
}

// -----------------------------
// Start spel met ronde 1
// -----------------------------
updateBottles();
startRound(0);
</script>

</body>
</html>



